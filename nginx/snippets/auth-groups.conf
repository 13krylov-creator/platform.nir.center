# =============================================================================
# Сниппет проверки групп/ролей пользователя
# =============================================================================
# Использование (после include auth.conf):
#
# location /admin {
#     include /etc/nginx/snippets/auth.conf;
#     include /etc/nginx/snippets/auth-groups.conf;
#     
#     # Разрешить только группе admins
#     if ($auth_groups !~ "admins") {
#         return 403;
#     }
#     
#     proxy_pass http://upstream;
# }
# =============================================================================

# ПРИМЕЧАНИЕ: Этот файл содержит примеры проверки групп.
# Используйте конструкции ниже в своих location-блоках.

# -----------------------------------------------------------------------------
# Пример 1: Проверка одной группы
# -----------------------------------------------------------------------------
# if ($auth_groups !~ "admins") {
#     return 403;
# }

# -----------------------------------------------------------------------------
# Пример 2: Проверка нескольких групп (ИЛИ)
# -----------------------------------------------------------------------------
# set $allowed 0;
# if ($auth_groups ~ "admins") { set $allowed 1; }
# if ($auth_groups ~ "managers") { set $allowed 1; }
# if ($allowed = 0) { return 403; }

# -----------------------------------------------------------------------------
# Пример 3: Использование map для проверки групп (рекомендуется)
# -----------------------------------------------------------------------------
# В nginx.conf или в server-блоке добавьте:
#
# map $auth_groups $has_admin_access {
#     default 0;
#     "~*admins" 1;
#     "~*superusers" 1;
# }
#
# Затем в location:
# if ($has_admin_access = 0) {
#     return 403;
# }
